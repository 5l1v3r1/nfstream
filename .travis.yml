language: python

python:
  - "3.4"
  - "3.5"
  - "3.6"
  - "3.7"

matrix:
  include:
    - os: osx
      compiler: clang

    - os: linux
      compiler: gcc
      addons:
        apt:
          packages:
            - libpcap-dev
            - autogen

    - os: linux
      compiler: clang
      addons:
        apt:
          packages:
            - libpcap-dev
            - autogen

    - os: linux
      compiler: gcc-8
      addons:
        apt:
          sources:
            - ubuntu-toolchain-r-test
          packages:
            - g++-8
            - libpcap-dev
            - autogen
      env:
        - MATRIX_EVAL="CC=gcc-8 && CXX=g++-8"

    - os: linux
      compiler: gcc-9
      addons:
        apt:
          sources:
            - ubuntu-toolchain-r-test
          packages:
            - g++-9
            - libpcap-dev
            - autogen
      env:
        - MATRIX_EVAL="CC=gcc-9 && CXX=g++-9"

    - os: linux
      compiler: clang-8
      addons:
        apt:
          sources:
            - ubuntu-toolchain-r-test
            - llvm-toolchain-trusty-8
          packages:
            - clang-8
            - libpcap-dev
            - autogen
      env:
        - MATRIX_EVAL="CC=clang-8 && CXX=clang++-8"

    - os: linux
      compiler: clang-7
      addons:
        apt:
          sources:
            - ubuntu-toolchain-r-test
            - llvm-toolchain-trusty-7
          packages:
            - clang-7
            - libpcap-dev
            - autogen
      env:
        - MATRIX_EVAL="CC=clang-7 && CXX=clang++-7"

before_install:
  - eval "${MATRIX_EVAL}"

install:
  - pip install -r requirements.txt
  - pip install codecov
  - python setup.py install

script:
  - coverage run tests.py

after_success:
  - codecov